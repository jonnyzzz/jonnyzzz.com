<!doctype html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8" />
<title>Catching exceptions with less code in Kotlin &#8211; Eugene Petrenko</title>
<meta name="description" content="A tiny inline function for consise try/catch
"/>
<meta name="keywords" content="jonnyzzz, Евгений Петренко, Eugene Petrenko, kotlin, kotlin-bytecode, jvm, tip" />


<!-- Twitter Cards -->
<meta name="twitter:title" content="Catching exceptions with less code in Kotlin -- Eugene Petrenko" />
<meta name="twitter:description" content="A tiny inline function for consise try/catch
" />
<meta name="twitter:site" content="@jonnyzzz" />
<meta name="twitter:creator" content="@jonnyzzz" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://jonnyzzz.com/images/me.jpg" />

<!-- Open Graph -->

<meta property="og:type" content="article" />
<meta property="og:image" content="https://jonnyzzz.com/images/me.jpg" />
<meta property="og:title" content="Catching exceptions with less code in Kotlin -- Eugene Petrenko" />
<meta property="og:description" content="A tiny inline function for consise try/catch
" />
<meta property="og:url" content="https://jonnyzzz.com/blog/2017/02/15/catchall/" />
<meta property="og:site_name" content="Eugene Petrenko" />

<meta property="article:tag" content="jonnyzzz" />

<meta property="article:tag" content="Евгений Петренко" />

<meta property="article:tag" content="Eugene Petrenko" />


<meta property="article:tag" content="kotlin" />

<meta property="article:tag" content="kotlin-bytecode" />

<meta property="article:tag" content="jvm" />

<meta property="article:tag" content="tip" />



<!-- Webmaster Tools verfication -->
<meta name="google-site-verification" content="MJZCyfst2Tx4KyxbOIQu1fZyOSwA_JkQu73zJcfsl2g" />




<link rel="canonical" href="https://jonnyzzz.com/blog/2017/02/15/catchall/" />
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" />

<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css" />

<link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png" />
<link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" />
<link rel="manifest" href="/images/manifest.json" />
<meta name="msapplication-TileColor" content="#ffffff" />
<meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png" />
<meta name="theme-color" content="#ffffff" />

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav">
	    <ul>
      
		    <li><a href="/" >Home</a></li>
		  
		    <li><a href="/about/" >About</a></li>
		  
		    <li><a href="/blog/" >Blog</a></li>
		  
		    <li><a href="/projects/" >Projects</a></li>
		  
		    <li><a href="/talks/" >Talks</a></li>
		  
		    <li><a href="/tags/" >Tags</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<header class="masthead">
	<div class="wrap">
      
      <h1 class="site-title"><a href="/">Eugene Petrenko</a></h1>
		<h2 class="site-description" itemprop="description">Founding Engineering Leader | Agentic AI DevTools & Experience</h2>
	</div>
</header><!-- /.masthead -->


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
          <li><a href="/tags/#kotlin" title="Pages tagged kotlin">kotlin</a></li><li><a href="/tags/#kotlin-bytecode" title="Pages tagged kotlin-bytecode">kotlin-bytecode</a></li><li><a href="/tags/#jvm" title="Pages tagged jvm">jvm</a></li><li><a href="/tags/#tip" title="Pages tagged tip">tip</a></li>
        </ul>
        
          <h1 class="entry-title">Catching exceptions with less code in Kotlin</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <img src="/images/me.jpg" class="bio-photo" alt="Eugene Petrenko bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Eugene Petrenko</span></span>
        <span class="entry-date date published"><time datetime="2017-02-15T00:00:00+00:00">February 15, 2017</time></span>
        
        
        <span class="social-share-x">
  <a href="https://x.com/intent/tweet?hashtags=kotlin,kotlin-bytecode,jvm,tip&amp;text=Catching%20exceptions%20with%20less%20code%20in%20Kotlin&amp;url=https://jonnyzzz.com/blog/2017/02/15/catchall/&amp;via=jonnyzzz" title="Share on X" itemprop="X" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" style="vertical-align: middle; fill: currentColor;"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg> Post</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=https://jonnyzzz.com/blog/2017/02/15/catchall/" title="Share on Facebook" itemprop="Facebook" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" style="vertical-align: middle; fill: currentColor;"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg> Like</a>
</span>
<!-- /.social-share -->

      </footer>
      <div class="entry-content">
        <p>A tiny inline function for consise try/catch</p>

<p>In JVM every call can throw an exception. In Java language, we have dedicated declaration that a method is 
expected to throw some exception types. But still, some other (<code class="language-plaintext highlighter-rouge">Throwable</code>, <code class="language-plaintext highlighter-rouge">Error</code>, <code class="language-plaintext highlighter-rouge">RuntimeException</code>) exceptions 
may still be thrown.</p>

<p>In Kotlin there are no checked exceptions (like, say in C#). Sill, one have to expect
any possible exception being thrown from any possible place.</p>

<p>Most cases it’s ok and one should not do anything specific about exceptions. Still, there are other places, 
where an exception may break code logic. In asynchronous applications (for example with RxJava, Netty, grpc-java) where 
most of the code is a callback, it may turn out necessary to make sure an exception is not breaking some 
outer login.</p>

<p>A trivial solution is to use <code class="language-plaintext highlighter-rouge">try/catch</code>. But it makes a code quite ugly when you have several statements to call. It 
may look like that</p>

<figure class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"> <span class="k">try</span> <span class="p">{</span>
   <span class="nf">callAction1</span><span class="p">()</span>
 <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">t</span> <span class="p">:</span> <span class="nc">ExceptionType</span><span class="p">)</span> <span class="p">{</span>
   <span class="nf">handleAction1Error</span><span class="p">()</span>
 <span class="p">}</span>
 <span class="k">try</span> <span class="p">{</span>
   <span class="nf">callAction2</span><span class="p">()</span>
 <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">t</span> <span class="p">:</span> <span class="nc">ExceptionType</span><span class="p">)</span> <span class="p">{</span>
   <span class="nf">handleAction2Error</span><span class="p">()</span>
 <span class="p">}</span>
 <span class="c1">/// ....</span>
 <span class="k">try</span> <span class="p">{</span>
   <span class="nf">callActionN</span><span class="p">()</span>
 <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">t</span> <span class="p">:</span> <span class="nc">ExceptionType</span><span class="p">)</span> <span class="p">{</span>
   <span class="nf">handleActionNError</span><span class="p">()</span>
 <span class="p">}</span></code></pre></figure>

<p>A good think here is that <code class="language-plaintext highlighter-rouge">try/catch</code> is expression in Kotlin, but still it is quite long to use.</p>

<p>In my application, I found that about 80% of such catches were done to 
log actual problem and to continue forking further. Meaning <code class="language-plaintext highlighter-rouge">handleActionNError()</code> functions in my case were 
calls to a <code class="language-plaintext highlighter-rouge">Logger</code>.</p>

<p>There is now equivalent way in Java to replace this long construction. Of course, it is possible to pass a 
lambda expression into a function like <code class="language-plaintext highlighter-rouge">catchAll</code>. But this would change a program and it would add extra 
object creation in most of the cases.</p>

<p>One can implement similar <code class="language-plaintext highlighter-rouge">catchAll</code> function in Kotlin too. Thanks to 
<a href="https://kotlinlang.org/docs/reference/inline-functions.html">inline functions</a>
it has no overhead at all.</p>

<p>This is the function I use:</p>

<figure class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"><span class="k">inline</span> <span class="k">fun</span> <span class="nf">catchAll</span><span class="p">(</span><span class="nc">LOG</span><span class="p">:</span> <span class="nc">Logger</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="p">()</span> <span class="p">-&gt;</span> <span class="nc">Unit</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="nf">action</span><span class="p">()</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nc">Throwable</span><span class="p">)</span> <span class="p">{</span>
    <span class="nc">LOG</span><span class="p">.</span><span class="nf">warn</span><span class="p">(</span><span class="s">"Failed to $message. ${t.message}"</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>So now I may rewrite the above example in a way consise fashion</p>

<figure class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"> <span class="nf">catchAll</span><span class="p">(</span><span class="nc">LOG</span><span class="p">,</span> <span class="s">"action1"</span><span class="p">)</span> <span class="p">{</span>
   <span class="nf">callAction1</span><span class="p">()</span>
 <span class="p">}</span>
 <span class="nf">catchAll</span><span class="p">(</span><span class="nc">LOG</span><span class="p">,</span> <span class="s">"action2"</span><span class="p">)</span> <span class="p">{</span>
   <span class="nf">callAction2</span><span class="p">()</span>
 <span class="p">}</span>
 <span class="c1">///  ....</span>
 <span class="nf">catchAll</span><span class="p">(</span><span class="nc">LOG</span><span class="p">,</span> <span class="s">"actionN"</span><span class="p">)</span> <span class="p">{</span>
   <span class="nf">callActionN</span><span class="p">()</span>
 <span class="p">}</span></code></pre></figure>

<p>Every usage of the function <code class="language-plaintext highlighter-rouge">catchAll</code> is inlined by Kotlin compiler in to a caller method bodies. Kotlin compiler also
inlines the action anonymous function <code class="language-plaintext highlighter-rouge">action</code> too. There is no overhead! Let’s consider the following
example:</p>

<figure class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"><span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
  <span class="nf">catchAll</span><span class="p">(</span><span class="nc">LOG</span><span class="p">,</span> <span class="s">"println"</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Test console output"</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>The following bytecode is generated out of it. Note. I use IntelliJ IDEA 2017.1 EAP with Kotlin 1.0.6 plugin. The generated
bytecode may change with a future version of tools.</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">public final static main([Ljava/lang/String;)V
    @Lorg/jetbrains/annotations/NotNull;() // invisible, parameter 0
    TRYCATCHBLOCK L0 L1 L2 java/lang/Throwable
   L3
    ALOAD 0
    LDC "args"
    INVOKESTATIC kotlin/jvm/internal/Intrinsics.checkParameterIsNotNull (Ljava/lang/Object;Ljava/lang/String;)V
   L4
    LINENUMBER 17 L4
    GETSTATIC LOG.INSTANCE : LLOG;
    CHECKCAST Logger
    ASTORE 1
    LDC "println"
    ASTORE 2
    NOP
   L5
    LINENUMBER 24 L5
   L6
   L0
    NOP
   L7
    LINENUMBER 25 L7
    NOP
   L8
    LINENUMBER 18 L8
    LDC "Test console output"
    ASTORE 3
    NOP
   L9
    GETSTATIC java/lang/System.out : Ljava/io/PrintStream;
    ALOAD 3
    INVOKEVIRTUAL java/io/PrintStream.println (Ljava/lang/Object;)V
   L10
   L11
    LINENUMBER 18 L11
   L12
    LINENUMBER 19 L12
   L13
    NOP
   L1
    GOTO L14
   L2
    LINENUMBER 26 L2
    ASTORE 3
   L15
    LINENUMBER 27 L15
    ALOAD 1
    NEW java/lang/StringBuilder
    DUP
    INVOKESPECIAL java/lang/StringBuilder.&lt;init&gt; ()V
    LDC "Failed to "
    INVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;
    ALOAD 2
    INVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;
    LDC ". "
    INVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;
    ALOAD 3
    INVOKEVIRTUAL java/lang/Throwable.getMessage ()Ljava/lang/String;
    INVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;
    INVOKEVIRTUAL java/lang/StringBuilder.toString ()Ljava/lang/String;
    ALOAD 3
    INVOKEVIRTUAL Logger.warn (Ljava/lang/String;Ljava/lang/Object;)V
   L16
    LINENUMBER 28 L16
   L14
    LINENUMBER 29 L14
   L17
   L18
    LINENUMBER 20 L18
    RETURN
   L19
    LOCALVARIABLE $i$a$1$catchAll I L8 L13 4
    LOCALVARIABLE t$iv Ljava/lang/Throwable; L2 L16 3
    LOCALVARIABLE LOG$iv LLogger; L5 L17 1
    LOCALVARIABLE message$iv Ljava/lang/String; L5 L17 2
    LOCALVARIABLE $i$f$catchAll I L5 L17 5
    LOCALVARIABLE args [Ljava/lang/String; L3 L19 0
    MAXSTACK = 3
    MAXLOCALS = 6</code></pre></figure>

<p>As we see the <code class="language-plaintext highlighter-rouge">catchAll</code> function call is inlined. We have <code class="language-plaintext highlighter-rouge">println</code> call as-is, without any anonymous function 
wrappers. Any combination of <code class="language-plaintext highlighter-rouge">catchAll</code> calls generates similar bytecode with <code class="language-plaintext highlighter-rouge">try/catch</code> blocks. Once can easily combine 
such calls to make a program easier to read on some higher level.</p>

<p>Disclaimer. Checked or unchecked exceptions are meaningful. I’m not trying to promote the idea to catch all possible exceptions
in every possible statement. The goal is to show it is possible to create a tiny function that would help to recure a number
of similar code snippets and improve readability. It is up to you to decide if an error is OK to ignore or to log without propagation.</p>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/blog/2016/09/16/power-of-dsl/" class="btn" title="The power of templating in a DSL">Previous</a>
      
      
        <a href="/blog/2017/03/01/guarded-by-lock/" class="btn" title="Guard access by lock in Kotlin">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>
  &copy; 2005—2026 Eugene Petrenko.
  <br />
  Unless otherwise noted, the content on the website is licensed under a
  <a href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> license.
  <br />
  Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using
  the <a href="https://mademistakes.com/work/so-simple-jekyll-theme/" rel="nofollow">So Simple Theme</a>.
</span>
<div class="social-icons">
  <a href="https://x.com/jonnyzzz" title="Eugene Petrenko on X" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
  <a href="https://linkedin.com/in/jonnyzzz" title="Eugene Petrenko on LinkedIn" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/></svg></a>
  <a href="https://github.com/jonnyzzz" title="Eugene Petrenko on Github" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z"/></svg></a>
  <a href="/feed.xml" title="Atom/RSS feed"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1z"/></svg></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script>
  // Open external links in new tab
  Array.from(document.links).forEach(link => {
    // For development: 0.0.0.0, localhost, 127.0.0.1 are all local
    const localHosts = ['localhost', '127.0.0.1', '0.0.0.0'];
    const linkIsLocal = localHosts.includes(link.hostname);
    const pageIsLocal = localHosts.includes(window.location.hostname);

    // Internal if: both are local dev hosts, or hostnames match exactly
    const isInternal = (linkIsLocal && pageIsLocal) ||
                       (link.hostname === window.location.hostname);

    if (!isInternal) {
      link.target = '_blank';
    }
  });
</script>


<!-- Google Analytics (gtag.js) -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'analytics_storage': 'denied'
  });
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BXXDX0ERFP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-BXXDX0ERFP');
</script>
<!-- End Google Analytics -->




<!--SYNTAX HIGHLIGHTER - Lazy loads PrismJS only when code blocks are present-->
<script>
(function() {
  // Check if page has any code blocks that need highlighting
  if (!document.querySelector('pre code, code[class*="language-"]')) return;

  // Load CSS
  var cssFiles = [
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/themes/prism.min.css',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/line-numbers/prism-line-numbers.min.css',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/toolbar/prism-toolbar.min.css'
  ];
  cssFiles.forEach(function(href) {
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = href;
    document.head.appendChild(link);
  });

  // Load JS in sequence (core first, then plugins)
  var jsFiles = [
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/components/prism-core.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/autoloader/prism-autoloader.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/line-numbers/prism-line-numbers.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/toolbar/prism-toolbar.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/show-language/prism-show-language.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js'
  ];

  function loadScript(index) {
    if (index >= jsFiles.length) {
      // All scripts loaded, highlight code
      if (window.Prism) Prism.highlightAll();
      return;
    }
    var script = document.createElement('script');
    script.src = jsFiles[index];
    script.onload = function() { loadScript(index + 1); };
    document.head.appendChild(script);
  }
  loadScript(0);
})();
</script>



</body>
</html>
