<!doctype html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8" />
<title>Hints in Stack Traces on the JVM &#8211; Eugene Petrenko</title>
<meta name="description" content="Encode context in a thread dump or an exception stack trace for the JVM.
"/>
<meta name="keywords" content="jonnyzzz, Евгений Петренко, Eugene Petrenko, jvm, debug, trace, library, opensource, stacktrace, frame, stack, java, named-stack-frames" />


<!-- Twitter Cards -->
<meta name="twitter:title" content="Hints in Stack Traces on the JVM -- Eugene Petrenko" />
<meta name="twitter:description" content="Encode context in a thread dump or an exception stack trace for the JVM.
" />
<meta name="twitter:site" content="@jonnyzzz" />
<meta name="twitter:creator" content="@jonnyzzz" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://jonnyzzz.com/images/me.jpg" />

<!-- Open Graph -->

<meta property="og:type" content="article" />
<meta property="og:image" content="https://jonnyzzz.com/images/me.jpg" />
<meta property="og:title" content="Hints in Stack Traces on the JVM -- Eugene Petrenko" />
<meta property="og:description" content="Encode context in a thread dump or an exception stack trace for the JVM.
" />
<meta property="og:url" content="https://jonnyzzz.com/blog/2017/04/12/named-frames-v2/" />
<meta property="og:site_name" content="Eugene Petrenko" />

<meta property="article:tag" content="jonnyzzz" />

<meta property="article:tag" content="Евгений Петренко" />

<meta property="article:tag" content="Eugene Petrenko" />


<meta property="article:tag" content="jvm" />

<meta property="article:tag" content="debug" />

<meta property="article:tag" content="trace" />

<meta property="article:tag" content="library" />

<meta property="article:tag" content="opensource" />

<meta property="article:tag" content="stacktrace" />

<meta property="article:tag" content="frame" />

<meta property="article:tag" content="stack" />

<meta property="article:tag" content="java" />

<meta property="article:tag" content="named-stack-frames" />



<!-- Webmaster Tools verfication -->
<meta name="google-site-verification" content="MJZCyfst2Tx4KyxbOIQu1fZyOSwA_JkQu73zJcfsl2g" />




<link rel="canonical" href="https://jonnyzzz.com/blog/2017/04/12/named-frames-v2/" />
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" />

<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css" />

<link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png" />
<link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" />
<link rel="manifest" href="/images/manifest.json" />
<meta name="msapplication-TileColor" content="#ffffff" />
<meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png" />
<meta name="theme-color" content="#ffffff" />

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav">
	    <ul>
      
		    <li><a href="/" >Home</a></li>
		  
		    <li><a href="/about/" >About</a></li>
		  
		    <li><a href="/blog/" >Blog</a></li>
		  
		    <li><a href="/projects/" >Projects</a></li>
		  
		    <li><a href="/talks/" >Talks</a></li>
		  
		    <li><a href="/tags/" >Tags</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<header class="masthead">
	<div class="wrap">
      
      <h1 class="site-title"><a href="/">Eugene Petrenko</a></h1>
		<h2 class="site-description" itemprop="description">Founding Engineering Leader | Agentic AI DevTools & Experience</h2>
	</div>
</header><!-- /.masthead -->


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
          <li><a href="/tags/#jvm" title="Pages tagged jvm">jvm</a></li><li><a href="/tags/#debug" title="Pages tagged debug">debug</a></li><li><a href="/tags/#trace" title="Pages tagged trace">trace</a></li><li><a href="/tags/#library" title="Pages tagged library">library</a></li><li><a href="/tags/#opensource" title="Pages tagged opensource">opensource</a></li><li><a href="/tags/#stacktrace" title="Pages tagged stacktrace">stacktrace</a></li><li><a href="/tags/#frame" title="Pages tagged frame">frame</a></li><li><a href="/tags/#stack" title="Pages tagged stack">stack</a></li><li><a href="/tags/#java" title="Pages tagged java">java</a></li><li><a href="/tags/#named-stack-frames" title="Pages tagged named-stack-frames">named-stack-frames</a></li>
        </ul>
        
          <h1 class="entry-title">Hints in Stack Traces on the JVM</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <img src="/images/me.jpg" class="bio-photo" alt="Eugene Petrenko bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Eugene Petrenko</span></span>
        <span class="entry-date date published"><time datetime="2017-04-12T00:00:00+00:00">April 12, 2017</time></span>
        
        
        <span class="social-share-x">
  <a href="https://x.com/intent/tweet?hashtags=jvm,debug,trace,library,opensource,stacktrace,frame,stack,java,named-stack-frames&amp;text=Hints%20in%20Stack%20Traces%20on%20the%20JVM&amp;url=https://jonnyzzz.com/blog/2017/04/12/named-frames-v2/&amp;via=jonnyzzz" title="Share on X" itemprop="X" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" style="vertical-align: middle; fill: currentColor;"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg> Post</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=https://jonnyzzz.com/blog/2017/04/12/named-frames-v2/" title="Share on Facebook" itemprop="Facebook" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" style="vertical-align: middle; fill: currentColor;"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg> Like</a>
</span>
<!-- /.social-share -->

      </footer>
      <div class="entry-content">
        <p>Encode context in a thread dump or an exception stack trace for the JVM.</p>

<p>Remember a production application stack trace or thread dump? Were you able to understand 
what a thread was downing? Why was a thread idling/hanging/waiting? What was the context of it? 
What a command was it? Or, say you were digging the roots of a NullPointerException stack trace?</p>

<p>Most time it’s hard.</p>

<p>There is a simple remedy. One may call <code class="language-plaintext highlighter-rouge">Threads.setName</code> to set/unset thread
name to indicate current activity and/or to add more information.</p>

<p>Hey, be aware of the <code class="language-plaintext highlighter-rouge">Threads.setName</code>. Some other code may also use it in their way.
Please, do not spoil it, if you can</p>

<p>Unfortunately, exception stack trace does not container thread name. So the fragile context is
lost if an exception is thrown. The only hope it is logged correctly, and logger includes
a thread name. Surprise! The full thread name.</p>

<p>What else? Why cannot we include the information locally and so that it is not 
lost in an exception or in a logger message? Can we make it more context-aware and readable?</p>

<h1 id="an-example">An example</h1>

<p>Consider an application, which runs a request for a given, say, <code class="language-plaintext highlighter-rouge">userId</code>. And it crashes with code like</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Exception in thread "main" com.jonnyzzz.blog.example.wtf.RemoteCrashServiceTimeOutException
	at com.jonnyzzz.blog.example.wtf.RemoteCrashMicroServiceAccessImpl.itWillNotCrash(crash.kt:5)
	at com.jonnyzzz.blog.example.logic.business.BusinessLogic.mightyMethod(BusinessLogic.kt:7)
	at com.jonnyzzz.blog.example.db.transaction.internals.InternalsForSure.transaction(InternalsForSure.kt:9)
	at com.jonnyzzz.blog.example.db.transaction.internals.InternalsForSure.transaction(InternalsForSure.kt:7)
	at com.jonnyzzz.blog.example.db.transaction.internals.InternalsForSure.transaction(InternalsForSure.kt:7)
	at com.jonnyzzz.blog.example.db.transaction.internals.InternalsForSure.transaction(InternalsForSure.kt:7)
	at com.jonnyzzz.blog.example.db.transaction.internals.InternalsForSure.transaction(InternalsForSure.kt:7)
	at com.jonnyzzz.blog.example.db.vendor.fun.AmazingDBSupport.runThisCodeFinally(AmazingDBSupport.kt:7)
	at com.jonnyzzz.blog.example.tansaction.meta.JokingTransaction.crzTr(JokingTransaction.kt:7)
	at com.jonnyzzz.blog.example.tansaction.Transaction.transaction(Transaction.kt:7)
	at com.jonnyzzz.blog.example.system.SystemInvariant.promoteB(SystemInvariant.kt:7)
	at com.jonnyzzz.blog.example.Ent.processA(Ent.kt:7)
	at com.jonnyzzz.blog.example.web.Controller.executeRequest(Controller.kt:10)
	at com.jonnyzzz.blog.example.EnterpriseAppKt.main(EnterpriseApp.kt:13)</code></pre></figure>

<p>What was the context of the failure above? Does it somehow related to parameters that were around?</p>

<h1 id="named-frames">Named Frames</h1>

<p>I created the <a href="https://github.com/jonnyzzz/named-java-frames">Named Frames</a>
library, which aims to help by including an additional information as <em>method calls</em>.</p>

<p>Let’s now update the code and include <code class="language-plaintext highlighter-rouge">userId</code> and RemoteCrashMicroService backend URL into the thread
dump. That is done be wrapping method calls with code like that:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">NamedStackFrame</span><span class="o">.</span><span class="na">global</span><span class="o">().</span><span class="na">forName</span><span class="o">(</span><span class="s">"YOUR TEXT HERE"</span><span class="o">).</span><span class="na">run</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// it is called from a method, which contains 'YOUR TEXT HERE' in the full name</span>
<span class="o">});</span></code></pre></figure>

<p>The updated thread dump from the exception is now the following</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Exception in thread "main" com.jonnyzzz.blog.example.wtf.RemoteCrashServiceTimeOutException
	at com.jonnyzzz.blog.example.wtf.RemoteCrashMicroServiceAccessImpl$itWillNotCrash$1.call(crash.kt:8)
	at com.jonnyzzz.blog.example.wtf.RemoteCrashMicroServiceAccessImpl$itWillNotCrash$1.call(crash.kt:5)

	at __. service = backend-452 .__.call(JavaGeneratorTemplate.java:39)

	at com.jonnyzzz.blog.example.wtf.RemoteCrashMicroServiceAccessImpl.itWillNotCrash(crash.kt:7)
	at com.jonnyzzz.blog.example.logic.business.BusinessLogic.mightyMethod(BusinessLogic.kt:7)
	at com.jonnyzzz.blog.example.db.transaction.internals.InternalsForSure.transaction(InternalsForSure.kt:9)
	at com.jonnyzzz.blog.example.db.transaction.internals.InternalsForSure.transaction(InternalsForSure.kt:7)
	at com.jonnyzzz.blog.example.db.transaction.internals.InternalsForSure.transaction(InternalsForSure.kt:7)
	at com.jonnyzzz.blog.example.db.transaction.internals.InternalsForSure.transaction(InternalsForSure.kt:7)
	at com.jonnyzzz.blog.example.db.transaction.internals.InternalsForSure.transaction(InternalsForSure.kt:7)
	at com.jonnyzzz.blog.example.db.vendor.fun.AmazingDBSupport.runThisCodeFinally(AmazingDBSupport.kt:7)
	at com.jonnyzzz.blog.example.tansaction.meta.JokingTransaction.crzTr(JokingTransaction.kt:7)
	at com.jonnyzzz.blog.example.tansaction.Transaction.transaction(Transaction.kt:7)
	at com.jonnyzzz.blog.example.system.SystemInvariant.promoteB(SystemInvariant.kt:7)
	at com.jonnyzzz.blog.example.Ent.processA(Ent.kt:7)
	at com.jonnyzzz.blog.example.web.Controller$executeRequest$1.call(Controller.kt:12)
	at com.jonnyzzz.blog.example.web.Controller$executeRequest$1.call(Controller.kt:7)

	at __. user = jonnyzzz .__.call(JavaGeneratorTemplate.java:39)

	at com.jonnyzzz.blog.example.web.Controller.executeRequest(Controller.kt:11)
	at com.jonnyzzz.blog.example.EnterpriseAppKt.main(EnterpriseApp.kt:13)</code></pre></figure>

<p>This one now includes the sensible information (as service name and userId)
which can be used to debug the original problem.</p>

<h1 id="api">API</h1>

<p>Named stack frames API is easy and flexible. 
The main entry point is <code class="language-plaintext highlighter-rouge">org.jonnyzzz.stack.NamedStackFrame</code>. There you may use either <code class="language-plaintext highlighter-rouge">#global()</code> method to access 
statically cached factory of named framed. 
The better is to use <code class="language-plaintext highlighter-rouge">#newInstance()</code> method to have an instance of the factory to explicitly control the lifetime.</p>

<p>Both methods return an instance of <code class="language-plaintext highlighter-rouge">org.jonnyzzz.stack.NamedExecutor</code> interface, which contains all possible methods to wrap
a call with a named frame.</p>

<h1 id="implementation">Implementation</h1>

<p>The implementation is covered in <a href="/blog/2014/04/26/named-stack-frames-for-jvm/">the older post</a>. Note, the
API is slightly changed in 0.2.x.</p>

<p>The idea is to on-the-fly generate classes for every given name. All generated classes are loaded with a dedicated
classloader and cached.</p>

<p>We implement our own class file weaver to avoid external dependencies from other libraries and thus to
simplify adoption of this library in your project.</p>

<p>The library attempts to escape some <em>bad</em> symbols from names you pass. All such symbols are replaced with ‘_’.</p>

<h1 id="namedstackframe-costs">NamedStackFrame Costs</h1>

<p>Custom information in stack traces is not free. We create and load classes to implement it. This means, 
it’s your responsibility to make sure you will not consume all JVM memory on that.</p>

<p>Practically, you should understand the number of possible names is limited and fits in the memory. That’s it.</p>

<h1 id="profiler-grouping-of-calls">Profiler Grouping of Calls</h1>

<p>Do you use a profiler to monitor your application? A profiler presents such named 
methods (just like ordinary methods) as different method calls. That means you’ll see a distribution of calls.</p>

<p>You’ll see a distribution of time spent by each name: a distribution by <code class="language-plaintext highlighter-rouge">userId</code>, <code class="language-plaintext highlighter-rouge">action type</code> or <code class="language-plaintext highlighter-rouge">serviceId</code>
for the example above.</p>

<h1 id="android-support">Android Support</h1>

<p>All the time I was wondering if it’s helpful for Android applications as well. Do you like the idea?
Please contribute!</p>

<h1 id="license">License</h1>

<p>The library is <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a></p>

<h1 id="download">Download</h1>

<p>Sources are on <a href="https://github.com/jonnyzzz/named-java-frames">GitHub</a></p>

<p>Binaries are on JCenter / Bintray</p>

<p><a href="https://bintray.com/jonnyzzz/maven/named-frames/_latestVersion"> <img src="https://api.bintray.com/packages/jonnyzzz/maven/named-frames/images/download.svg" alt="Download" /> </a> <a href="https://travis-ci.org/jonnyzzz/named-java-frames"> <img src="https://travis-ci.org/jonnyzzz/named-java-frames.svg?branch=master" alt="Build Status" /></a></p>

<p>In Gradle, just add</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>repositories {
  jcenter()
}

dependencies {
  compile 'org.jonnyzzz.named-frames:named-frames:&lt;LATEST VERSION&gt;'
}
</code></pre></div></div>

<h1 id="issues">Issues</h1>

<p>On <a href="https://github.com/jonnyzzz/named-java-frames">GitHub</a></p>


        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/blog/2017/03/29/when-for-sealed-classes/" class="btn" title="Sealed classes and 'when' expression">Previous</a>
      
      
        <a href="/blog/2017/04/26/corotines-or-state-machine/" class="btn" title="Bytecode behind coroutines in Kotlin">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>
  &copy; 2005—2026 Eugene Petrenko.
  <br />
  Unless otherwise noted, the content on the website is licensed under a
  <a href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> license.
  <br />
  Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using
  the <a href="https://mademistakes.com/work/so-simple-jekyll-theme/" rel="nofollow">So Simple Theme</a>.
</span>
<div class="social-icons">
  <a href="https://x.com/jonnyzzz" title="Eugene Petrenko on X" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
  <a href="https://linkedin.com/in/jonnyzzz" title="Eugene Petrenko on LinkedIn" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/></svg></a>
  <a href="https://github.com/jonnyzzz" title="Eugene Petrenko on Github" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z"/></svg></a>
  <a href="/feed.xml" title="Atom/RSS feed"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1z"/></svg></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script>
  // Open external links in new tab
  Array.from(document.links).forEach(link => {
    // For development: 0.0.0.0, localhost, 127.0.0.1 are all local
    const localHosts = ['localhost', '127.0.0.1', '0.0.0.0'];
    const linkIsLocal = localHosts.includes(link.hostname);
    const pageIsLocal = localHosts.includes(window.location.hostname);

    // Internal if: both are local dev hosts, or hostnames match exactly
    const isInternal = (linkIsLocal && pageIsLocal) ||
                       (link.hostname === window.location.hostname);

    if (!isInternal) {
      link.target = '_blank';
    }
  });
</script>


<!-- Google Analytics (gtag.js) -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'analytics_storage': 'denied'
  });
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BXXDX0ERFP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-BXXDX0ERFP');
</script>
<!-- End Google Analytics -->




<!--SYNTAX HIGHLIGHTER - Lazy loads PrismJS only when code blocks are present-->
<script>
(function() {
  // Check if page has any code blocks that need highlighting
  if (!document.querySelector('pre code, code[class*="language-"]')) return;

  // Load CSS
  var cssFiles = [
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/themes/prism.min.css',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/line-numbers/prism-line-numbers.min.css',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/toolbar/prism-toolbar.min.css'
  ];
  cssFiles.forEach(function(href) {
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = href;
    document.head.appendChild(link);
  });

  // Load JS in sequence (core first, then plugins)
  var jsFiles = [
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/components/prism-core.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/autoloader/prism-autoloader.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/line-numbers/prism-line-numbers.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/toolbar/prism-toolbar.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/show-language/prism-show-language.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js'
  ];

  function loadScript(index) {
    if (index >= jsFiles.length) {
      // All scripts loaded, highlight code
      if (window.Prism) Prism.highlightAll();
      return;
    }
    var script = document.createElement('script');
    script.src = jsFiles[index];
    script.onload = function() { loadScript(index + 1); };
    document.head.appendChild(script);
  }
  loadScript(0);
})();
</script>



</body>
</html>
