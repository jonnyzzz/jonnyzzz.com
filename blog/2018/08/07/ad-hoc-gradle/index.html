<!doctype html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8" />
<title>Ad-hoc Plugins with Gradle &#8211; Eugene Petrenko</title>
<meta name="description" content="Gradle code reuse on steroids.
"/>
<meta name="keywords" content="jonnyzzz, Евгений Петренко, Eugene Petrenko, gradle, java, groovy, plugin, gradle-plugin, build, dependencies" />


<!-- Twitter Cards -->
<meta name="twitter:title" content="Ad-hoc Plugins with Gradle -- Eugene Petrenko" />
<meta name="twitter:description" content="Gradle code reuse on steroids.
" />
<meta name="twitter:site" content="@jonnyzzz" />
<meta name="twitter:creator" content="@jonnyzzz" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://jonnyzzz.com/images/me.jpg" />

<!-- Open Graph -->

<meta property="og:type" content="article" />
<meta property="og:image" content="https://jonnyzzz.com/images/me.jpg" />
<meta property="og:title" content="Ad-hoc Plugins with Gradle -- Eugene Petrenko" />
<meta property="og:description" content="Gradle code reuse on steroids.
" />
<meta property="og:url" content="https://jonnyzzz.com/blog/2018/08/07/ad-hoc-gradle/" />
<meta property="og:site_name" content="Eugene Petrenko" />

<meta property="article:tag" content="jonnyzzz" />

<meta property="article:tag" content="Евгений Петренко" />

<meta property="article:tag" content="Eugene Petrenko" />


<meta property="article:tag" content="gradle" />

<meta property="article:tag" content="java" />

<meta property="article:tag" content="groovy" />

<meta property="article:tag" content="plugin" />

<meta property="article:tag" content="gradle-plugin" />

<meta property="article:tag" content="build" />

<meta property="article:tag" content="dependencies" />



<!-- Webmaster Tools verfication -->
<meta name="google-site-verification" content="MJZCyfst2Tx4KyxbOIQu1fZyOSwA_JkQu73zJcfsl2g" />




<link rel="canonical" href="https://jonnyzzz.com/blog/2018/08/07/ad-hoc-gradle/" />
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" />

<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css" />

<link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png" />
<link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" />
<link rel="manifest" href="/images/manifest.json" />
<meta name="msapplication-TileColor" content="#ffffff" />
<meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png" />
<meta name="theme-color" content="#ffffff" />

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav">
	    <ul>
      
		    <li><a href="/" >Home</a></li>
		  
		    <li><a href="/about/" >About</a></li>
		  
		    <li><a href="/blog/" >Blog</a></li>
		  
		    <li><a href="/projects/" >Projects</a></li>
		  
		    <li><a href="/talks/" >Talks</a></li>
		  
		    <li><a href="/tags/" >Tags</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<header class="masthead">
	<div class="wrap">
      
      <h1 class="site-title"><a href="/">Eugene Petrenko</a></h1>
		<h2 class="site-description" itemprop="description">Founding Engineering Leader | Agentic AI DevTools & Experience</h2>
	</div>
</header><!-- /.masthead -->


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
          <li><a href="/tags/#gradle" title="Pages tagged gradle">gradle</a></li><li><a href="/tags/#java" title="Pages tagged java">java</a></li><li><a href="/tags/#groovy" title="Pages tagged groovy">groovy</a></li><li><a href="/tags/#plugin" title="Pages tagged plugin">plugin</a></li><li><a href="/tags/#gradle-plugin" title="Pages tagged gradle-plugin">gradle-plugin</a></li><li><a href="/tags/#build" title="Pages tagged build">build</a></li><li><a href="/tags/#dependencies" title="Pages tagged dependencies">dependencies</a></li>
        </ul>
        
          <h1 class="entry-title">Ad-hoc Plugins with Gradle</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <img src="/images/me.jpg" class="bio-photo" alt="Eugene Petrenko bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Eugene Petrenko</span></span>
        <span class="entry-date date published"><time datetime="2018-08-07T00:00:00+00:00">August 07, 2018</time></span>
        
        
        <span class="social-share-x">
  <a href="https://x.com/intent/tweet?hashtags=gradle,java,groovy,plugin,gradle-plugin,build,dependencies&amp;text=Ad-hoc%20Plugins%20with%20Gradle&amp;url=https://jonnyzzz.com/blog/2018/08/07/ad-hoc-gradle/&amp;via=jonnyzzz" title="Share on X" itemprop="X" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" style="vertical-align: middle; fill: currentColor;"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg> Post</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=https://jonnyzzz.com/blog/2018/08/07/ad-hoc-gradle/" title="Share on Facebook" itemprop="Facebook" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" style="vertical-align: middle; fill: currentColor;"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg> Like</a>
</span>
<!-- /.social-share -->

      </footer>
      <div class="entry-content">
        <p>Gradle code reuse on steroids.</p>

<p>There are many ways to reuse code in <a href="https://gradle.org">Gradle</a> builds. The 
major and the most powerful one is
to write a Gradle plugin either as an independent project or inside <code class="language-plaintext highlighter-rouge">buildSrc</code>. 
You may want to check official documentation
<a href="https://docs.gradle.org/current/userguide/plugins.html">here</a>.
All of these approaches require additional efforts from both the development and the infrastructure sides.
Will you and your team be happy of you doing that?</p>

<p>I want to share the short-cut to make code reuse without too much work.
I will consider a
<a href="https://docs.gradle.org/current/userguide/multi_project_builds.html">Multi-Project Gradle builds</a>.
It makes less to no sense for a Single Project Gradle builds, there is nothing to reuse, generally.</p>

<p>What Gradle code to reuse? There are a plenty of places for it. The most trivial is
dependencies. You’d like to try using the same versions of libraries along the sub-projects.
Repositories, packaging, testing, plugins, configurations are the places of reuse too. Yet another
example is Kotlin plugin or Scala plugin configuration.</p>

<h2 id="subprojects">Subprojects</h2>

<p>The most standard feature in Gradle builds. 
<code class="language-plaintext highlighter-rouge">subprojects</code> is the 
<a href="https://docs.gradle.org/current/userguide/multi_project_builds.html#sec:subproject_configuration">block</a>
where you apply the same code snippet to all child (any level)
projects.</p>

<p>Projects in Gradle forms a tree structure, it replicates the filesystem. 
A <em>parent</em> project in Gradle is the project that is in the parent folder 
of a child project folder. The <code class="language-plaintext highlighter-rouge">build.gradle</code> is optional and you are not obliged to
have one. For example,
the line <code class="language-plaintext highlighter-rouge">include ':a:b:c:d'</code> from a <code class="language-plaintext highlighter-rouge">settings.gradle</code> file 
defines the following child projects: <code class="language-plaintext highlighter-rouge">a</code>, <code class="language-plaintext highlighter-rouge">b</code>, <code class="language-plaintext highlighter-rouge">c</code> and <code class="language-plaintext highlighter-rouge">d</code>.</p>

<p>I like to use <code class="language-plaintext highlighter-rouge">subprojects { .... } </code> block in parent projects to configure 
common stuff, like dependencies, plugins, repositories. Let’s see the example:</p>

<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">subprojects</span> <span class="o">{</span>
    <span class="k">repositories</span> <span class="o">{</span>
        <span class="n">jcenter</span><span class="o">()</span>
        <span class="n">mavenCentral</span><span class="o">()</span>
    <span class="o">}</span>
 
    <span class="k">dependencies</span> <span class="o">{</span>
        <span class="n">compile</span> <span class="s2">"org.slf4j:slf4j-api:1.7.25"</span>
        <span class="n">testCompile</span> <span class="s2">"junit:junit:4.12"</span>
    <span class="o">}</span>   
<span class="o">}</span>        
</code></pre></div></div>

<p>Here I set up the default maven repositories in all child projects.
Also, I include the standard dependencies, namely, <a href="https://www.slf4j.org/">SLF4J</a> and
<a href="https://junit.org/junit4/">JUnit4</a>. The configuration of
<a href="https://junit.org/junit5/docs/current/user-guide/">JUnit5</a> is yet
another great example to share Gradle code between projects.</p>

<p>It is possible that one does not want to configure all child projects,
but some projects only. It is possible. But, It’d be better to move that
project somewhere instead. I use the following,
<code class="language-plaintext highlighter-rouge">configure(project(':a'), project('b').subprojects) { .... }</code> to 
apply the same settings to several projects only.</p>

<h2 id="apply-from-file">Apply From File</h2>

<p>The next way to apply common configuration is to use <code class="language-plaintext highlighter-rouge">apply: from: file(...foo.gradle)</code> syntax.
You move the configuration to a dedicated file somewhere in the project. You
include the file to every project, where you need it.</p>

<p>That is the way to re-include the same part of your Gradle script into many
projects. The only problem here is that the <code class="language-plaintext highlighter-rouge">build.gradle</code> and the <code class="language-plaintext highlighter-rouge">...foo.gradle</code> 
are executed in an isolated environment. It might be hard to pass parameters
back and forth.</p>

<h2 id="a-common-plugin">A Common Plugin</h2>

<p>The most generic approach is to create a Gradle plugin or a custom task. 
There is the <a href="https://docs.gradle.org/current/userguide/plugins.html">documentation</a> page.
Let’s see, how to try writing a plugin just in our <code class="language-plaintext highlighter-rouge">.gradle</code> files.</p>

<p>I use <a href="https://jetbrains.com/idea">IntelliJ IDEA</a> to navigate to interfaces and javadocs.
It helps me a lot with code completion and error highlighting
directly in <code class="language-plaintext highlighter-rouge">.gradle</code> files, which actually use Groovy.</p>

<p>Gradle allows declaring classes in <code class="language-plaintext highlighter-rouge">.gradle</code> files. That is the way to
create an ad-hoc plugin just in a parent project. You should know, that you 
will not be able to see the created class outside the <code class="language-plaintext highlighter-rouge">.gradle</code> file, where
you created it. The good part is that you may still use <code class="language-plaintext highlighter-rouge">subprojects</code> and write the following:</p>

<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">subprojects</span> <span class="o">{</span>
  <span class="n">apply</span> <span class="nl">plugin:</span> <span class="n">MyPluginClass</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">MyPluginClass</span> <span class="kd">implements</span> <span class="n">Plugin</span><span class="o">&lt;</span><span class="kt">Project</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">Project</span> <span class="n">project</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>That is the most trivial way to create you own Gradle plugin and to enable it 
for all child projects. It does not require one to invest into infrastructure 
(e.g. deployment of a plugin, build configurations and so on).</p>

<p>You may use <code class="language-plaintext highlighter-rouge">org.gradle.api.plugins.ExtensionContainer#create(...)</code>
function to add your own Gradle DSL
<a href="https://docs.gradle.org/current/userguide/custom_plugins.html#sec:mapping_extension_properties_to_task_properties">extension</a>.
That is the standard way to include parameters from the plugin usages.</p>

<h2 id="ext-block">Ext Block</h2>

<p>What if I need to apply the ad-hoc plugin only to some selected sub-projects? And I do not
like to code it in the parent project <code class="language-plaintext highlighter-rouge">build.gradle</code>. Similarly, I may want to reuse some dependencies
especially for selected projects.</p>

<p>The <code class="language-plaintext highlighter-rouge">ext { .. }</code> <a href="https://docs.gradle.org/current/userguide/writing_build_scripts.html#sec:declaring_variables">block</a>
in Gradle is for me. I combine it with the <code class="language-plaintext highlighter-rouge">subprojects { .. }</code> block.
<a href="http://groovy-lang.org/closures.html">Closure</a> (or Lambda) is a possible value of a
property from <code class="language-plaintext highlighter-rouge">ext</code> block too.
Let’s combine those features to level-up the code-reuse in our Gradle script. First, in 
a parent project we add the code:</p>

<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">subprojects</span> <span class="o">{</span>
  <span class="n">ext</span> <span class="o">{</span>
    <span class="n">dep_arrow</span> <span class="o">=</span> <span class="o">{</span><span class="kt">Project</span> <span class="n">project</span> <span class="o">-&gt;</span>
      <span class="n">project</span><span class="o">.</span><span class="na">dependencies</span> <span class="o">{</span>
        <span class="n">compile</span> <span class="s2">"io.arrow-kt:arrow-core:0.6.1"</span>
        <span class="n">compile</span> <span class="s2">"io.arrow-kt:arrow-typeclasses:0.6.1"</span>
        <span class="n">compile</span> <span class="s2">"io.arrow-kt:arrow-data:0.6.1"</span>
    <span class="o">}</span>
  <span class="o">}</span>  
<span class="o">}</span>
</code></pre></div></div>

<p>Then in a selected child project I simply enable <a href="https://arrow-kt.io/">Arrow</a> library by
writing the only one line:</p>
<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ext</span><span class="o">.</span><span class="na">dep_arrow</span><span class="o">(</span><span class="n">project</span><span class="o">)</span>
</code></pre></div></div>

<p>Theoretically, It should work with an implicitly captured Project in Closures, without <code class="language-plaintext highlighter-rouge">Project</code> parameter, e.g.
<code class="language-plaintext highlighter-rouge">dep_arrow = { dependencies { ... } }</code>. I was lazy to try that.</p>

<p>The similar trick helps to enable ad-hoc Gradle plugins too.</p>

<h1 id="the-use-case">The Use Case</h1>

<p>I work on an project, where we decided to use micro-services. Technically, it
means, we split the whole code base into the set of small executables. 
The same language, namely Kotlin/JVM, is used to implement all services. There are common things one need 
to have for every service, for example, it includes logging configuration, communication
setup, crashes handling. I need the only way to pack those services too.</p>

<p>What did I do? At first, I use <a href="https://docs.gradle.org/current/userguide/application_plugin.html">Application plugin</a>
to implement the executable. It executes the same entry-point class. The entry-point class
finds the micro-service class to start it. I plan to use the <a href="https://github.com/GoogleContainerTools/jib">jib</a> plugin
to wrap my services into Docker images.</p>

<p>From the Gradle side of things. I created scripts for one service manually. Then, I turned that code into an ad-hoc
Gradle plugin. I enabled the plugin explicitly in the service projects.
The plugin configures the Application plugin, adds dependencies, adds
an <a href="https://docs.gradle.org/current/userguide/custom_plugins.html#sec:mapping_extension_properties_to_task_properties">extension</a>
to get service-specific parameters.</p>

<p>Right now, the service is created with only a few Gradle lines:</p>
<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ext</span><span class="o">.</span><span class="na">micro_service</span><span class="o">(</span><span class="n">project</span><span class="o">)</span>

<span class="n">micro_service</span> <span class="o">{</span>
    <span class="n">entryClassName</span> <span class="o">=</span> <span class="s1">'&lt;THE ENTRY POINT CLASS OF THE SERVICE&gt;'</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Let your builds be simply. Feed free to ask me for details in the comments below. 
There is also the official <a href="https://docs.gradle.org/current">documentation</a> for Gradle.</p>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/blog/2018/07/23/terraform-if/" class="btn" title="Condition in Terraform and API Gateway">Previous</a>
      
      
        <a href="/blog/2018/10/29/kn-libcurl-windows/" class="btn" title="libcurl and Kotlin/Native on Windows">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>
  &copy; 2005—2026 Eugene Petrenko.
  <br />
  Unless otherwise noted, the content on the website is licensed under a
  <a href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> license.
  <br />
  Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using
  the <a href="https://mademistakes.com/work/so-simple-jekyll-theme/" rel="nofollow">So Simple Theme</a>.
</span>
<div class="social-icons">
  <a href="https://x.com/jonnyzzz" title="Eugene Petrenko on X" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
  <a href="https://linkedin.com/in/jonnyzzz" title="Eugene Petrenko on LinkedIn" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/></svg></a>
  <a href="https://github.com/jonnyzzz" title="Eugene Petrenko on Github" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z"/></svg></a>
  <a href="https://www.youtube.com/channel/UCn5M0Ct8SxLlHq0za4kGG1A" title="Eugene Petrenko on YouTube" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.498 6.186a2.959 2.959 0 0 0-2.079-2.08C19.58 3.6 12 3.6 12 3.6s-7.58 0-9.419.507a2.959 2.959 0 0 0-2.08 2.079C0 8.025 0 12 0 12s0 3.975.501 5.814a2.959 2.959 0 0 0 2.08 2.079C4.42 20.4 12 20.4 12 20.4s7.58 0 9.419-.507a2.959 2.959 0 0 0 2.08-2.079C24 15.975 24 12 24 12s0-3.975-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg></a>
  <a href="/feed.xml" title="Atom/RSS feed"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1z"/></svg></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script>
  // Open external links in new tab
  Array.from(document.links).forEach(link => {
    // For development: 0.0.0.0, localhost, 127.0.0.1 are all local
    const localHosts = ['localhost', '127.0.0.1', '0.0.0.0'];
    const linkIsLocal = localHosts.includes(link.hostname);
    const pageIsLocal = localHosts.includes(window.location.hostname);

    // Internal if: both are local dev hosts, or hostnames match exactly
    const isInternal = (linkIsLocal && pageIsLocal) ||
                       (link.hostname === window.location.hostname);

    if (!isInternal) {
      link.target = '_blank';
    }
  });
</script>


<!-- Google Analytics (gtag.js) -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'analytics_storage': 'denied'
  });
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BXXDX0ERFP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-BXXDX0ERFP');
</script>
<!-- End Google Analytics -->




<!--SYNTAX HIGHLIGHTER - Lazy loads PrismJS only when code blocks are present-->
<script>
(function() {
  // Check if page has any code blocks that need highlighting
  if (!document.querySelector('pre code, code[class*="language-"]')) return;

  // Load CSS
  var cssFiles = [
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/themes/prism.min.css',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/line-numbers/prism-line-numbers.min.css',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/toolbar/prism-toolbar.min.css'
  ];
  cssFiles.forEach(function(href) {
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = href;
    document.head.appendChild(link);
  });

  // Load JS in sequence (core first, then plugins)
  var jsFiles = [
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/components/prism-core.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/autoloader/prism-autoloader.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/line-numbers/prism-line-numbers.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/toolbar/prism-toolbar.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/show-language/prism-show-language.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js'
  ];

  function loadScript(index) {
    if (index >= jsFiles.length) {
      // All scripts loaded, highlight code
      if (window.Prism) Prism.highlightAll();
      return;
    }
    var script = document.createElement('script');
    script.src = jsFiles[index];
    script.onload = function() { loadScript(index + 1); };
    document.head.appendChild(script);
  }
  loadScript(0);
})();
</script>



</body>
</html>
