<!doctype html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8" />
<title>JNI with Kotlin/Native &#8211; Eugene Petrenko</title>
<meta name="description" content="Kotlin both sides: Native and JVM"/>
<meta name="keywords" content="jonnyzzz, Евгений Петренко, Eugene Petrenko, jvm, java, kotlin, kotlin-native, jni, native" />


<!-- Twitter Cards -->
<meta name="twitter:title" content="JNI with Kotlin/Native -- Eugene Petrenko" />
<meta name="twitter:description" content="Kotlin both sides: Native and JVM" />
<meta name="twitter:site" content="@jonnyzzz" />
<meta name="twitter:creator" content="@jonnyzzz" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://jonnyzzz.com/images/me.jpg" />

<!-- Open Graph -->

<meta property="og:type" content="article" />
<meta property="og:image" content="https://jonnyzzz.com/images/me.jpg" />
<meta property="og:title" content="JNI with Kotlin/Native -- Eugene Petrenko" />
<meta property="og:description" content="Kotlin both sides: Native and JVM" />
<meta property="og:url" content="https://jonnyzzz.com/blog/2019/12/15/jni-kotlin/" />
<meta property="og:site_name" content="Eugene Petrenko" />

<meta property="article:tag" content="jonnyzzz" />

<meta property="article:tag" content="Евгений Петренко" />

<meta property="article:tag" content="Eugene Petrenko" />


<meta property="article:tag" content="jvm" />

<meta property="article:tag" content="java" />

<meta property="article:tag" content="kotlin" />

<meta property="article:tag" content="kotlin-native" />

<meta property="article:tag" content="jni" />

<meta property="article:tag" content="native" />



<!-- Webmaster Tools verfication -->
<meta name="google-site-verification" content="MJZCyfst2Tx4KyxbOIQu1fZyOSwA_JkQu73zJcfsl2g" />




<link rel="canonical" href="https://jonnyzzz.com/blog/2019/12/15/jni-kotlin/" />
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" />

<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css" />

<link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png" />
<link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" />
<link rel="manifest" href="/images/manifest.json" />
<meta name="msapplication-TileColor" content="#ffffff" />
<meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png" />
<meta name="theme-color" content="#ffffff" />

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav">
	    <ul>
      
		    <li><a href="/" >Home</a></li>
		  
		    <li><a href="/about/" >About</a></li>
		  
		    <li><a href="/blog/" >Blog</a></li>
		  
		    <li><a href="/projects/" >Projects</a></li>
		  
		    <li><a href="/talks/" >Talks</a></li>
		  
		    <li><a href="/tags/" >Tags</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<header class="masthead">
	<div class="wrap">
      
      <h1 class="site-title"><a href="/">Eugene Petrenko</a></h1>
		<h2 class="site-description" itemprop="description">Founding Engineering Leader | Agentic AI DevTools & Experience</h2>
	</div>
</header><!-- /.masthead -->


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
          <li><a href="/tags/#jvm" title="Pages tagged jvm">jvm</a></li><li><a href="/tags/#java" title="Pages tagged java">java</a></li><li><a href="/tags/#kotlin" title="Pages tagged kotlin">kotlin</a></li><li><a href="/tags/#kotlin-native" title="Pages tagged kotlin-native">kotlin-native</a></li><li><a href="/tags/#jni" title="Pages tagged jni">jni</a></li><li><a href="/tags/#native" title="Pages tagged native">native</a></li>
        </ul>
        
          <h1 class="entry-title">JNI with Kotlin/Native</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <img src="/images/me.jpg" class="bio-photo" alt="Eugene Petrenko bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Eugene Petrenko</span></span>
        <span class="entry-date date published"><time datetime="2019-12-15T00:00:00+00:00">December 15, 2019</time></span>
        
        
        <span class="social-share-x">
  <a href="https://x.com/intent/tweet?hashtags=jvm,java,kotlin,kotlin-native,jni,native&amp;text=JNI%20with%20Kotlin/Native&amp;url=https://jonnyzzz.com/blog/2019/12/15/jni-kotlin/&amp;via=jonnyzzz" title="Share on X" itemprop="X" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" style="vertical-align: middle; fill: currentColor;"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg> Post</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=https://jonnyzzz.com/blog/2019/12/15/jni-kotlin/" title="Share on Facebook" itemprop="Facebook" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" style="vertical-align: middle; fill: currentColor;"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg> Like</a>
</span>
<!-- /.social-share -->

      </footer>
      <div class="entry-content">
        <p>Calling native code from our cosy JVM environment was and is possible. JVM comes with
the magical JNI APIs layer to make that. In this post we show how to use the JNI
from a Kotlin/JVM program and how to implement the native
counter-part with Kotlin/Native.</p>

<p>The example project contains several parts:</p>
<ul>
  <li>The JVM part (define a native method, load native library, call the API)</li>
  <li>The Native part (build as shared library, register callback in the JVM, have fun)</li>
</ul>

<h2 id="the-jvm-side">The JVM Side</h2>

<p>Let’s implement the JVM side in Kotlin. It will be enough to have the following code:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="nn">org.jonnyzzz.jni.java</span>

<span class="kd">class</span> <span class="nc">NativeHost</span> <span class="p">{</span>
  <span class="k">external</span> <span class="k">fun</span> <span class="nf">callInt</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nc">Int</span><span class="p">)</span> <span class="p">:</span> <span class="nc">Int</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">external</code> keyword in Kotlin is the same as the <code class="language-plaintext highlighter-rouge">native</code> keyword in Java. Both mean
the implementation of the method comes from the native library.</p>

<h2 id="the-kotlinnative-shared-library">The Kotlin/Native Shared Library</h2>

<p>The experiment was to use the same programming language to implement the native
part too. We use <a href="https://kotlinlang.org/docs/reference/native-overview.html">Kotlin/Native</a>
for that.</p>

<p>The second point to try Kotlin/Native is to use the
<a href="https://kotlinlang.org/docs/reference/multiplatform.html">Kotlin Multiplatform Programming</a>
to share some code between Native and JVM worlds. I will omit examples of that
in the current post.</p>

<p>JVM looks for specific symbol names to resolve native methods. We may find 
<a href="https://docs.oracle.com/en/java/javase/11/docs/specs/jni/design.html#resolving-native-method-names">the full spec</a>
in the documentation. The <code class="language-plaintext highlighter-rouge">callInt</code> function has the following symbol name:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">jint</span> <span class="nf">Java_org_jonnyzzz_jni_java_NativeHost_callInt</span><span class="p">(</span><span class="n">JNIEnv</span> <span class="o">*</span><span class="n">env</span><span class="p">,</span>
                                                   <span class="n">jobject</span> <span class="n">obj</span><span class="p">,</span> 
                                                   <span class="n">jint</span> <span class="n">i</span><span class="p">);</span>
</code></pre></div></div>
<p>The first two parameters are added for all JNI calls. The <code class="language-plaintext highlighter-rouge">JNIEnv</code> allows
accessing the JVM to say create an object or throw an exception. We do
not need these parameters for our example, but we have to keep them for
binary compatibility. The function name in our example is generated
as follows:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Java_&lt;package name&gt;_&lt;class name&gt;_&lt;method_name&gt;
</code></pre></div></div>

<p>That encoding does not work for overloaded functions (there is on support for
overloads in C). The
<a href="https://docs.oracle.com/en/java/javase/11/docs/specs/jni/design.html#resolving-native-method-names">JNI specification</a>
defines how to create a longer names with mangling to overcome the limitation.</p>

<p>The following declaration in Kotlin/Native code
will implement it:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@CName</span><span class="p">(</span><span class="s">"Java_org_jonnyzzz_jni_java_NativeHost_callInt"</span><span class="p">)</span>
<span class="k">fun</span> <span class="nf">callInt</span><span class="p">(</span><span class="n">env</span><span class="p">:</span> <span class="nc">CPointer</span><span class="p">&lt;</span><span class="nc">JNIEnvVar</span><span class="p">&gt;,</span> <span class="n">clazz</span><span class="p">:</span> <span class="n">jclass</span><span class="p">,</span> <span class="n">it</span><span class="p">:</span> <span class="n">jint</span><span class="p">):</span> <span class="nf">jint</span> <span class="p">{</span>
  <span class="nf">initRuntimeIfNeeded</span><span class="p">()</span>
  <span class="nc">Platform</span><span class="p">.</span><span class="n">isMemoryLeakCheckerActive</span> <span class="p">=</span> <span class="k">false</span>

  <span class="nf">println</span><span class="p">(</span><span class="s">"Native function is executed with: $it"</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">it</span> <span class="p">+</span> <span class="mi">1</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Here we use the <code class="language-plaintext highlighter-rouge">@CName</code> annotation to instruct
<a href="https://kotlinlang.org/docs/reference/native/c_interop.html">the cinterop</a>
to export the function as a symbol of the shared library.</p>

<h2 id="the-c-interop-setup">The C interop Setup</h2>

<p>The example above requires a project setup to work. 
We need to import the <code class="language-plaintext highlighter-rouge">jni.h</code> header into Kotlin/Native.
<a href="https://kotlinlang.org/docs/reference/native/c_interop.html">The cinterop</a>
tool helps us to generate Kotlin code from a C library definitions.</p>

<h2 id="the-project-setup">The Project Setup</h2>

<p>Before we jump into the native world, let’s create a project. We’ll use Gradle project,
written in Kotlin. You may <a href="https://github.com/jonnyzzz/kotlin-jni-mix">see the code</a> from
my GitHub or create a new one from a scratch. It will the
<a href="https://kotlinlang.org/docs/reference/building-mpp-with-gradle.html">kotlin multiplatform</a> plugin.</p>

<p>The initial project setup in a <code class="language-plaintext highlighter-rouge">build.gradle.kts</code> file could look like that:</p>
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plugins</span> <span class="p">{</span>
  <span class="nf">kotlin</span><span class="p">(</span><span class="s">"multiplatform"</span><span class="p">)</span> <span class="n">version</span> <span class="s">"1.3.61"</span>
<span class="p">}</span>

<span class="nf">repositories</span> <span class="p">{</span>
  <span class="nf">mavenCentral</span><span class="p">()</span>
<span class="p">}</span>

<span class="nf">kotlin</span> <span class="p">{</span>
  <span class="nf">jvm</span><span class="p">()</span>

  <span class="nf">macosX64</span><span class="p">(</span><span class="s">"native"</span><span class="p">)</span> <span class="p">{</span><span class="o">..</span><span class="p">}</span> <span class="c1">// see below</span>

  <span class="n">sourceSets</span><span class="p">[</span><span class="s">"jvmMain"</span><span class="p">].</span><span class="nf">dependencies</span> <span class="p">{</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="nf">kotlin</span><span class="p">(</span><span class="s">"stdlib-jdk8"</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">macosX64</code> block defined the macOS shared library target. Rename it to
<code class="language-plaintext highlighter-rouge">mingwX64</code> for Windows, and <code class="language-plaintext highlighter-rouge">linuxX64</code> for Linux. Find more explanations on that
<a href="https://kotlinlang.org/docs/tutorials/native/dynamic-libraries.html">in the tutorial</a>
for Kotlin/Native. We use <a href="https://twitter.com/jonnyzzz/status/1206242931058892802?s=20">a script</a>
in the example repository to avoid manual configuration need.</p>

<p>We use the Kotlin/Native’s <code class="language-plaintext highlighter-rouge">cinterop</code> tool to import the <code class="language-plaintext highlighter-rouge">jni.h</code> declarations to Kotlin, 
e.g  <code class="language-plaintext highlighter-rouge">JNIEnv</code> or <code class="language-plaintext highlighter-rouge">jint</code> symbols. The whole script looks like that:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  macosX64("native") { // use linuxX64 or mingwX64 on other OS
    binaries {
      sharedLib()
    }

    compilations["main"].cinterops.create("jni") {
      val javaHome = File(System.getProperty("java.home")!!)
      packageName = "org.jonnyzzz.jni"
      includeDirs(
              Callable { File(javaHome, "include") },
              Callable { File(javaHome, "include/darwin") },
              Callable { File(javaHome, "include/linux") },
              Callable { File(javaHome, "include/win32") }
      )
    }
  }
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">src/nativeInterop/cinterop/jni.def</code> file contains the definitions for the c interop, 
it should container the only one line to instruct the interop tool what headers to use:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>headers = jni.h
</code></pre></div></div>

<h2 id="putting-all-together">Putting all Together</h2>

<p>The example is ready. We use Kotlin/JVM to talk to Kotlin/Native in the same project.
The project sources are <a href="https://github.com/jonnyzzz/kotlin-jni-mix">on my GitHub</a>, 
try it, open in IntelliJ and have fun.</p>

<p>You’ll have the following code in the console:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  kotlin-jni-mix git:(master) ✗ ./gradlew run

&gt; Configure project :
Kotlin Multiplatform Projects are an experimental feature.

&gt; Task :linkDebugSharedNative
Produced library API in libkotlin_jni_mix_api.h

&gt; Task :linkReleaseSharedNative
Produced library API in libkotlin_jni_mix_api.h

&gt; Task :run
Native function is executed with: 42
ret from the native: 43
</code></pre></div></div>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/blog/2019/06/25/gradle-kotlin-migration-4/" class="btn" title="Migrating to Gradle Kotlin DSL - Groovy Closure">Previous</a>
      
      
        <a href="/blog/2020/04/06/delegated-property/" class="btn" title="Delegated Properties in Kotlin">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>
  &copy; 2005—2026 Eugene Petrenko.
  <br />
  Unless otherwise noted, the content on the website is licensed under a
  <a href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> license.
  <br />
  Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using
  the <a href="https://mademistakes.com/work/so-simple-jekyll-theme/" rel="nofollow">So Simple Theme</a>.
</span>
<div class="social-icons">
  <a href="https://x.com/jonnyzzz" title="Eugene Petrenko on X" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
  <a href="https://linkedin.com/in/jonnyzzz" title="Eugene Petrenko on LinkedIn" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/></svg></a>
  <a href="https://github.com/jonnyzzz" title="Eugene Petrenko on Github" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z"/></svg></a>
  <a href="https://www.youtube.com/channel/UC9Q18kLRzcJ1xtOJ3GGvxBw" title="Eugene Petrenko on YouTube" target="_blank"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.498 6.186a2.959 2.959 0 0 0-2.079-2.08C19.58 3.6 12 3.6 12 3.6s-7.58 0-9.419.507a2.959 2.959 0 0 0-2.08 2.079C0 8.025 0 12 0 12s0 3.975.501 5.814a2.959 2.959 0 0 0 2.08 2.079C4.42 20.4 12 20.4 12 20.4s7.58 0 9.419-.507a2.959 2.959 0 0 0 2.08-2.079C24 15.975 24 12 24 12s0-3.975-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg></a>
  <a href="/feed.xml" title="Atom/RSS feed"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1z"/></svg></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script>
  // Open external links in new tab
  Array.from(document.links).forEach(link => {
    // For development: 0.0.0.0, localhost, 127.0.0.1 are all local
    const localHosts = ['localhost', '127.0.0.1', '0.0.0.0'];
    const linkIsLocal = localHosts.includes(link.hostname);
    const pageIsLocal = localHosts.includes(window.location.hostname);

    // Internal if: both are local dev hosts, or hostnames match exactly
    const isInternal = (linkIsLocal && pageIsLocal) ||
                       (link.hostname === window.location.hostname);

    if (!isInternal) {
      link.target = '_blank';
    }
  });
</script>


<!-- Google Analytics (gtag.js) -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'analytics_storage': 'denied'
  });
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BXXDX0ERFP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-BXXDX0ERFP');
</script>
<!-- End Google Analytics -->




<!--SYNTAX HIGHLIGHTER - Lazy loads PrismJS only when code blocks are present-->
<script>
(function() {
  // Check if page has any code blocks that need highlighting
  if (!document.querySelector('pre code, code[class*="language-"]')) return;

  // Load CSS
  var cssFiles = [
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/themes/prism.min.css',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/line-numbers/prism-line-numbers.min.css',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/toolbar/prism-toolbar.min.css'
  ];
  cssFiles.forEach(function(href) {
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = href;
    document.head.appendChild(link);
  });

  // Load JS in sequence (core first, then plugins)
  var jsFiles = [
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/components/prism-core.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/autoloader/prism-autoloader.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/line-numbers/prism-line-numbers.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/toolbar/prism-toolbar.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/show-language/prism-show-language.min.js',
    'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js'
  ];

  function loadScript(index) {
    if (index >= jsFiles.length) {
      // All scripts loaded, highlight code
      if (window.Prism) Prism.highlightAll();
      return;
    }
    var script = document.createElement('script');
    script.src = jsFiles[index];
    script.onload = function() { loadScript(index + 1); };
    document.head.appendChild(script);
  }
  loadScript(0);
})();
</script>



</body>
</html>
