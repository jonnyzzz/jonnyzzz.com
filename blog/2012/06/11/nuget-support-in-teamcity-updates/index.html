<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>NuGet Support in TeamCity Updates &#8211; Eugene Petrenko</title>

<meta name="keywords" content="nuget, teamcity 7.1, package, ci, c#, trigger, build, teamcity EAP, nuget feed, nupkg, opensource, teamcity plugin, teamcity">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="NuGet Support in TeamCity Updates">

<meta name="twitter:site" content="@jonnyzzz">
<meta name="twitter:creator" content="@jonnyzzz">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="NuGet Support in TeamCity Updates">

<meta property="og:url" content="/blog/2012/06/11/nuget-support-in-teamcity-updates/">
<meta property="og:site_name" content="Eugene Petrenko">





<link rel="canonical" href="/blog/2012/06/11/nuget-support-in-teamcity-updates/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Eugene Petrenko Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="/assets/js/vendor/html5shiv.min.js"></script>
  <script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<!--<link rel="shortcut icon" href="/favicon.ico">-->
<!-- 32x32 -->
<!--<link rel="shortcut icon" href="/favicon.png">-->
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<!--<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">-->
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<!--<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">-->
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<!--<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">-->
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">-->


<!-- Begin Cookie Consent plugin by Silktide - http://silktide.com/cookieconsent -->
<script type="text/javascript">
    window.cookieconsent_options = {"message":"This website uses cookies to ensure you get the best experience on our website","dismiss":"Got it!","learnMore":"More info","link":null,"theme":"light-bottom"};
</script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js"></script>
<!-- End Cookie Consent plugin -->


<!--SYNTAX HIGHLIGHTER BEGINS-->

<script src="/assets/syntax/syntax.js"></script>

<link rel="stylesheet" href="/assets/syntax/syntax.css" />

<!--SYNTAX HIGHLIGHTER ENDS-->


</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		        
		    
		    <li><a href="/about/" >About</a></li>
		  
		    
		        
		    
		    <li><a href="/blog/" >Blog</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
      <h1 class="site-title animated fadeIn"><a href="/">Eugene Petrenko</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Eugene @jonnyzzz Petrenko personal page and blog</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
          <li><a href="/tags/#nuget" title="Pages tagged nuget">nuget</a></li><li><a href="/tags/#teamcity 7.1" title="Pages tagged teamcity 7.1">teamcity 7.1</a></li><li><a href="/tags/#package" title="Pages tagged package">package</a></li><li><a href="/tags/#ci" title="Pages tagged ci">ci</a></li><li><a href="/tags/#c#" title="Pages tagged c#">c#</a></li><li><a href="/tags/#trigger" title="Pages tagged trigger">trigger</a></li><li><a href="/tags/#build" title="Pages tagged build">build</a></li><li><a href="/tags/#teamcity EAP" title="Pages tagged teamcity EAP">teamcity EAP</a></li><li><a href="/tags/#nuget feed" title="Pages tagged nuget feed">nuget feed</a></li><li><a href="/tags/#nupkg" title="Pages tagged nupkg">nupkg</a></li><li><a href="/tags/#opensource" title="Pages tagged opensource">opensource</a></li><li><a href="/tags/#teamcity plugin" title="Pages tagged teamcity plugin">teamcity plugin</a></li><li><a href="/tags/#teamcity" title="Pages tagged teamcity">teamcity</a></li>
        </ul>
        
          <h1 class="entry-title">NuGet Support in TeamCity Updates</h1>
        
      </header>
      <footer class="entry-meta">
        
          
        
        <span class="author vcard">By <span class="fn">Eugene Petrenko</span></span>
        <span class="entry-date date published"><time datetime="2012-06-11T18:26:00+02:00"><i class="fa fa-calendar-o"></i> June 11, 2012</time></span>
        <span class="entry-date date modified"><time datetime="2012-07-05T14:26:04.038+02:00"><i class="fa fa-pencil"></i> July 05, 2012</time></span>
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        
        
      </footer>
      <div class="entry-content">
        <p>I've created a branch v0.8 where there is mostly a java code. Thanks OData4j we
  implemented the the NuGet Feed in Java and thus I decided to remove stale .NET code from build and repository. We
  bundle builds from this branch in TeamCity 7.1 EAP builds. Still, builds are binary compatible with TeamCity 7.0,
  so you can give it a try there as well. </p> <h2>NuGet Versions</h2><p>Remember the time
  NuGet 1.7 was released. As it turned out, TeamCity provided NuGet feed was <a
    href="http://youtrack.jetbrains.com/issue/TW-21011">not aware</a> of newer NuGet feed queries. I'd like
  to say many thanks to NuGet team to make NuGet 1.8 <a href="https://nuget.codeplex.com/workitem/2066">support</a>
  be able to generate queries that TeamCity's feed is able to understand and process. So, if you like to use NuGet
  in TeamCity, you need to upgrade to NuGet 1.8. </p><p>In v0.8 branch I checked it some code that
  provides support of the latest NuGet 2.0. There was a bug in NuGet CommandLine installer that filtered NuGet 2.0
  out. Starting from NuGet 2.0 it is also required to set an environment variable <em>EnableNuGetPackageRestore</em>
  to allow NuGet install command work. </p> <h2>NuGet Trigger</h2><p>I had a set of requests
  to improve NuGet Packages Trigger <a href="http://youtrack.jetbrains.com/issue/TW-21397">performance</a>.
  The older implementation fetched all packages from the feed to report a trigger state. This turns out to be an
  overhead both for NuGet trigger and NuGet feed server. Starting from now, NuGet Packages Trigger will only query
  for latest package (in case you do not specify NuGet version filter). Thanks to <a
    href="https://twitter.com/#!/benphegan">Ben Phegan</a> who helped me to find a major bug in the trigger
  code. Not it is fixed on all active branches: v0.5-bugfix, v0.7 and v0.8 </p><p>Do you use <a
  href="http://nuget.codeplex.com/wikipage?title=Pre-Release%20Packages">Prerelease packages</a>? This is
  nice that it is now possible to mark package as beta or so. NuGet simple treats a package prerelease if the
  version looks-like <em>1.2.3-some_word</em> (still <em>1.2.3</em> is called not
  prerelease). Now it is possible to specify if you like to include or to ignore new prerelease packages in the
  trigger. </p>
<div class="separator" style="clear:both; text-align:center;"><a
  href="http://3.bp.blogspot.com/-7eDzuHB4zf8/T_QgWBAA4sI/AAAAAAAACJA/Yyum2M1GASo/s1600/Image_0096.png"
  imageanchor="1" style=""><img border="0" height="320" width="320"
                                src="http://3.bp.blogspot.com/-7eDzuHB4zf8/T_QgWBAA4sI/AAAAAAAACJA/Yyum2M1GASo/s320/Image_0096.png"/></a>
</div>
<h2>Packasges Installer</h2><p> I added an Visual Studio Solution file (.sln) parser into
  TeamCity NuGet Installer runner. Now it no longer requires you to have <em>packages/repository.config</em>
  file in version control in order to make NuGet Installer work. Installer parses .sln file to collect all project
  files where to check for <em>Packages.config</em> files. It also fetches packages from Solution-Wide
  packages file <em>.NuGet/packages.config</em> file. </p><p>You may know, there are two
  ways to update packages under solution from NuGet.exe: </p>
<ul>
  <li>Call <em>NuGet.exe
    update solution_file.sln</em></li>
  <li>call <em>NuGet.exe update Packages.config</em></li>
</ul><p>I
  added this option into NuGet Installer runner too. So now you may select the best suitable way to implement
  packages update. </p>
<div class="seperator" style="text-align:center"><a
  href="http://1.bp.blogspot.com/-FNb2677ByXg/T_Qht59DcjI/AAAAAAAACJM/st4SEsHbxtQ/s1600/Image_0098.png"
  imageanchor="1" style=""><img border="0" height="173" width="320"
                                src="http://1.bp.blogspot.com/-FNb2677ByXg/T_Qht59DcjI/AAAAAAAACJM/st4SEsHbxtQ/s320/Image_0098.png"/></a>
</div>
<h2>NuGet Distribution on Agents</h2><p>Remember, you have to select a version of NuGet from the
  list of all NuGet versions. It received may feedback messages form uses who tried to use it on the machine behind
  proxy or firewall. So I added an option in the dialog to <strong>upload</strong> a NuGet.CommandLine
  package into TeamCity in case you do not have an access to public NuGet feed or you like to use some custom build
  of NuGet. </p>
<div class="separator" style="text-align:center"><a
  href="http://3.bp.blogspot.com/-uMupE1fEdMM/T_Qjc-V9ndI/AAAAAAAACJY/Hmgz9Grc2Q4/s1600/Image_0100.png"
  imageanchor="1" style=""><img border="0" height="174" width="320"
                                src="http://3.bp.blogspot.com/-uMupE1fEdMM/T_Qjc-V9ndI/AAAAAAAACJY/Hmgz9Grc2Q4/s320/Image_0100.png"/></a>
</div></p><p>
  Do you use NuGet integration with TeamCity? Do you have something to share, to ask or to <a
  href="http://youtrack.jetbrains.com/dashboard/TW">post</a>? </p> <h2>Build Results</h2><p>There
  is a <em>NuGet Packages</em> tab in a build results page. There you may find information on the
  packages your build used. Now in the tab you may see NuGet packages that were consumed, created or published in/by
  the build. </p>
<div class="separator" style="text-align:center"><a
  href="http://2.bp.blogspot.com/-h6Xa8AW4Ylo/T_Spq5wIkDI/AAAAAAAACJo/nDXkAggclq0/s1600/Image_0210.png"
  imageanchor="1" style=""><img border="0" height="214" width="320"
                                src="http://2.bp.blogspot.com/-h6Xa8AW4Ylo/T_Spq5wIkDI/AAAAAAAACJo/nDXkAggclq0/s320/Image_0210.png"/></a>
</div>
<h2>Authenticated NuGet Feeds Support</h2><p>I did much work to make NuGet support Authenticated
  (aka Http basic authorization) feeds run smoothly under TeamCity. I found some issues in NuGet 2.0 that prevented
  me to roll out the support now. All my work is available in <em>nuget-auth</em> branch. </p><p>Recently
  I blogged more details about it <a
    href="/blog/2012/06/27/nuget-feed-authentication-research/">here</a></p> <h2>Download
  and Info:</h2><p>NuGet support update is available in the latest <a
  href="http://blogs.jetbrains.com/teamcity/2012/07/04/teamcity-7-1-eap-build-23732/">TeamCity 7.1 EAP</a>,
  the plugin is also binary-compatible with TeamCity 7.0 </p><p>For more information, see NuGet plugin
  home page at: <br/><a href="http://confluence.jetbrains.net/display/TW/NuGet+support">http://confluence.jetbrains.net/display/TW/NuGet+support</a><br
  />or download a latest build from TeamCity <a
    href="http://teamcity.jetbrains.com/repository/download/bt375/.lastSuccessful/dotNetPackagesSupport.zip">here</a>
</p>

        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'jonnyzzz'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/blog/2012/05/21/checkout-on-agent-tricks/" class="btn" title="Checkout on Agent Tricks">Previous</a>
      
      
        <a href="/blog/2012/06/25/nuget-and-feed-passwords/" class="btn" title="NuGet and Feed Passwords">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2015 Eugene Petrenko. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/" rel="nofollow">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="https://twitter.com/jonnyzzz" title="Eugene Petrenko on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	<a href="https://facebook.com/jonnyzzz" title="Eugene Petrenko on Facebook" target="_blank"><i class="fa fa-facebook-square fa-2x"></i></a>
	<a href="https://plus.google.com/+EugenePetrenko_jonnyzzz" title="Eugene Petrenko on Google+" target="_blank"><i class="fa fa-google-plus-square fa-2x"></i></a>
	<a href="https://linkedin.com/in/jonnyzzz" title="Eugene Petrenko on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
	<a href="http://stackoverflow.com/users/49811/eugene-petrenko" title="Eugene Petrenko on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
	<a href="https://instagram.com/jonnyzzz" title="Eugene Petrenko on Instagram" target="_blank"><i class="fa fa-instagram fa-2x"></i></a>
	<a href="https://www.flickr.com/photos/_jonny_" title="Eugene Petrenko on Flickr" target="_blank"><i class="fa fa-flickr fa-2x"></i></a>
	<a href="https://github.com/jonnyzzz" title="Eugene Petrenko on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  <a href="https://www.pinterest.com/jonnyzzz/" title="Eugene Petrenko on Pinterest" target="_blank"><i class="fa fa-pinterest fa-2x"></i></a>
	
  <a href="/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = '';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 'https://www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-70104598-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = 'https://stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



</body>
</html>
