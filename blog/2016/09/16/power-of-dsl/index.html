<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8" />
<title>The power of templating in a DSL &#8211; Eugene Petrenko</title>
<meta name="description" content="Welcome a powerful templating engine that 
is available for every DSL in a general 
purpose language.

"/>
<meta name="keywords" content="jonnyzzz, Евгений Петренко, Eugene Petrenko, dsl, the dsl way, kotlin, jvm, ide" />


<!-- Twitter Cards -->
<meta name="twitter:title" content="The power of templating in a DSL -- Eugene Petrenko" />
<meta name="twitter:description" content="Welcome a powerful templating engine that 
is available for every DSL in a general 
purpose language.

" />
<meta name="twitter:site" content="@jonnyzzz" />
<meta name="twitter:creator" content="@jonnyzzz" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://jonnyzzz.com/images/me.jpg" />

<!-- Open Graph -->

<meta property="og:type" content="article" />
<meta property="og:image" content="https://jonnyzzz.com/images/me.jpg" />
<meta property="og:title" content="The power of templating in a DSL -- Eugene Petrenko" />
<meta property="og:description" content="Welcome a powerful templating engine that 
is available for every DSL in a general 
purpose language.

" />
<meta property="og:url" content="https://jonnyzzz.com/blog/2016/09/16/power-of-dsl/" />
<meta property="og:site_name" content="Eugene Petrenko" />

<meta property="article:tag" content="jonnyzzz" />

<meta property="article:tag" content="Евгений Петренко" />

<meta property="article:tag" content="Eugene Petrenko" />


<meta property="article:tag" content="dsl" />

<meta property="article:tag" content="the dsl way" />

<meta property="article:tag" content="kotlin" />

<meta property="article:tag" content="jvm" />

<meta property="article:tag" content="ide" />



<!-- Webmaster Tools verfication -->
<meta name="google-site-verification" content="MJZCyfst2Tx4KyxbOIQu1fZyOSwA_JkQu73zJcfsl2g" />




<link rel="canonical" href="https://jonnyzzz.com/blog/2016/09/16/power-of-dsl/" />
<link href="https://feeds.feedburner.com/jonnyzzz" type="application/atom+xml" rel="alternate" title="ATOM Feed" />

<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css" />

<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on" />

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="/assets/js/vendor/html5shiv.min.js"></script>
  <script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png" />
<link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" />
<link rel="manifest" href="/images/manifest.json" />
<meta name="msapplication-TileColor" content="#ffffff" />
<meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png" />
<meta name="theme-color" content="#ffffff" />

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="/about/" >About</a></li>
		  
		    
		    <li><a href="/blog/" >Blog</a></li>
		  
		    
		    <li><a href="/projects/" >Projects</a></li>
		  
		    
		    <li><a href="/talks/" >Talks</a></li>
		  
		    
		    <li><a href="/tags/" >Tags</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
      <h1 class="site-title animated fadeIn"><a href="/">Eugene Petrenko</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">@jonnyzzz personal page and blog</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
          <li><a href="/tags/#dsl" title="Pages tagged dsl">dsl</a></li><li><a href="/tags/#the dsl way" title="Pages tagged the dsl way">the dsl way</a></li><li><a href="/tags/#kotlin" title="Pages tagged kotlin">kotlin</a></li><li><a href="/tags/#jvm" title="Pages tagged jvm">jvm</a></li><li><a href="/tags/#ide" title="Pages tagged ide">ide</a></li>
        </ul>
        
          <h1 class="entry-title">The power of templating in a DSL</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <img src="/images/me.jpg" class="bio-photo" alt="Eugene Petrenko bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Eugene Petrenko</span></span>
        <span class="entry-date date published"><time datetime="2016-09-16T00:00:00+00:00"><i class="fa fa-calendar-o"></i> September 16, 2016</time></span>
        
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        <span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=dsl,thedslway,kotlin,jvm,ide&amp;text=The%20power%20of%20templating%20in%20a%20DSL&amp;url=https://jonnyzzz.com/blog/2016/09/16/power-of-dsl/&amp;via=jonnyzzz" title="Share on Twitter" itemprop="Twitter" target="_blank"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=https://jonnyzzz.com/blog/2016/09/16/power-of-dsl/" title="Share on Facebook" itemprop="Facebook" target="_blank"><i class="fa fa-facebook-square"></i> Like</a>
</span>

<!-- /.social-share -->

        
      </footer>
      <div class="entry-content">
        <p>Welcome a powerful templating engine that 
is available for every DSL in a general 
purpose language.</p>

<h1 id="introduction">Introduction</h1>

<p>Let’s consider a general purpose language (e.g. Scala, Java, Kotlin)
and a library (or a DSL API library) which helps to define 
objects for some domain.</p>

<p>We use the library in a program to yield a domain objects.
This means we are allowed to mix the libraly calls with other 
general language calls features. This forms a templates.</p>

<p>You may recall a <code class="highlighter-rouge">.php</code> or <code class="highlighter-rouge">.jsp</code> condition or loop tags as an example.</p>

<p>For the DSL case the general purpose 
language turns into a powerfull templage engine. Unlike string 
templage engines, this approach allows a semantic aware templating as
all calls goes to the DSL API library.</p>

<p>Semantic aware templates can be used to enrich 
<a href="/blog/2016/09/02/dsl-building/">The DSL Way</a> approach
too.</p>

<p>Let’s consider examples.</p>

<h1 id="a-dsl-example">A DSL example</h1>

<p>I will be using <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a> as an IDE 
and <a href="https://kotlinlang.org">Kotlin</a> as \(Target Language \) below. Suppose
we have a DSL API library for logger configuration implemented in Kotlin. An
evaluation of <code class="highlighter-rouge">log4j</code> function yield a logger configuration 
(e.g. for <a href="http://logging.apache.org/log4j/1.2/">Log4j</a>).</p>

<p>Say we have the following code to setup
<a href="/blog/2016/09/09/log4j-dsl/">loggers</a>.</p>

<figure class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"> 
<span class="n">log4j</span> <span class="p">{</span>
  <span class="n">logger</span><span class="p">(</span><span class="s">"category2warn"</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">+</span> <span class="n">WARN</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>The goal is to configure a number of loggers in the exactly 
same way. Thanks to Kotlin language features, one is allowed to use a 
loop, e.g.</p>

<figure class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"> 
<span class="n">log4j</span> <span class="p">{</span>
  <span class="n">listOf</span><span class="p">(</span><span class="s">"A"</span><span class="p">,</span> <span class="s">"B"</span><span class="p">,</span> <span class="s">"C"</span><span class="p">).</span><span class="n">forEach</span> <span class="p">{</span>
    <span class="n">logger</span><span class="p">(</span><span class="s">"category2warn.$it"</span><span class="p">)</span> <span class="p">{</span>
      <span class="p">+</span> <span class="n">WARN</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>This is a straitforward example of a template engine. There 
is nothing specific to be done to have a template engine at all. A mix 
of languge features and DSL API library calls forms the template engine.</p>

<p>There are no loops support in the logger configuration itself, 
but thats to DSL API we are allowed to loop over several categories 
to generate all definitions.</p>

<p>The following part is now a template:</p>

<figure class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"> 
    <span class="n">logger</span><span class="p">(</span><span class="s">"category2warn.$it"</span><span class="p">)</span> <span class="p">{</span>
      <span class="p">+</span> <span class="n">WARN</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>One may go further and decide to extract the collection of categoring into 
a function. So we turn the logger configuration code into the following</p>

<figure class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"> 
<span class="n">log4j</span> <span class="p">{</span>
  <span class="n">listAllRootPackages</span><span class="p">().</span><span class="n">forEach</span> <span class="p">{</span>
    <span class="n">logger</span><span class="p">(</span><span class="s">"category2warn.$it"</span><span class="p">)</span> <span class="p">{</span>
      <span class="p">+</span> <span class="n">WARN</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Here we assume the <code class="highlighter-rouge">listAllRootPackages()</code> to return a list of 
categories. There is no longer necessary to have this 
function to return a constant list. Instead, it can be implemented
as we like it to, e.g. it may scan an application package to collect
all possible root categories. It may use some resources as the input.</p>

<p>Overall, this is the way to turn a static (and declarative) logger 
configuration to a flexible thing. It is now psedo-declarative. Meaning
there is another program, that yields a declarative configuration script
during a build phase. On that phase all templates are getting substituted.</p>

<p>A next step is to extract the actual category setup code (a template)</p>

<figure class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"> 
<span class="n">log4j</span> <span class="p">{</span>
  <span class="n">listAllRootPackages</span><span class="p">().</span><span class="n">forEach</span> <span class="p">{</span>
    <span class="n">declareCategory</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>At that point we have a shared library, where a category is declared 
in the <em>right</em> way and reused. Next we use a function aka template all other 
the place.</p>

<h1 id="closing">Closing</h1>

<p>The examples above show how a general purpose language can 
be turned into a powerfull templating engine for any DSL APIs.</p>

<p>It turns out that a general purpose language features turning 
it to a powerfull template engine for a given DSL. It’s up to 
a developer to decide which features to use. The only requirement
is to have a properly designed DSL API, so that such transformations 
were possible.</p>

<p>The example below illustrates a side-effect or a benefit of using 
<a href="/blog/2016/09/02/dsl-building/">The DSL Way</a>
to extend an IDE <strong>without</strong> writing any IDE specific code.
It shows how powerfull an \(Original Launguage\) can be
form the \(Target Language\) perspective.</p>

<p>You may take a look to
<a href="/blog/2016/09/09/log4j-dsl/">the post</a>
for more formal DSL description for a logger configurations.</p>


        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'jonnyzzz'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/blog/2016/09/09/log4j-dsl/" class="btn" title="Crafting Log4j Configuration DSL">Previous</a>
      
      
        <a href="/blog/2017/02/15/catchall/" class="btn" title="Catching exceptions with less code in Kotlin">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>
  &copy; 2005—2019 Eugene Petrenko.
  <br />
  Unless otherwise noted, the content on the website is licensed under a
  <a href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> license.
  <br />
  Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using
  the <a href="https://mademistakes.com/work/so-simple-jekyll-theme/" rel="nofollow">So Simple Theme</a>.
</span>
<div class="social-icons">
	<a href="https://twitter.com/jonnyzzz" title="Eugene Petrenko on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	<a href="https://facebook.com/jonnyzzz" title="Eugene Petrenko on Facebook" target="_blank"><i class="fa fa-facebook-square fa-2x"></i></a>
	<a href="https://plus.google.com/+EugenePetrenko_jonnyzzz" title="Eugene Petrenko on Google+" target="_blank"><i class="fa fa-google-plus-square fa-2x"></i></a>
	<a href="https://linkedin.com/in/jonnyzzz" title="Eugene Petrenko on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
	<a href="http://stackoverflow.com/users/49811/eugene-petrenko" title="Eugene Petrenko on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
	<a href="https://instagram.com/jonnyzzz" title="Eugene Petrenko on Instagram" target="_blank"><i class="fa fa-instagram fa-2x"></i></a>
	<a href="https://www.flickr.com/photos/_jonny_" title="Eugene Petrenko on Flickr" target="_blank"><i class="fa fa-flickr fa-2x"></i></a>
	<a href="https://github.com/jonnyzzz" title="Eugene Petrenko on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  <a href="https://www.pinterest.com/jonnyzzz/" title="Eugene Petrenko on Pinterest" target="_blank"><i class="fa fa-pinterest fa-2x"></i></a>
	
  <a href="https://feeds.feedburner.com/jonnyzzz" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = '';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 'https://www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-70104598-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = 'https://stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




<!-- MathJax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script type="text/javascript">
  window.cookieconsent_options = {"message":"This website uses cookies to ensure you get the best experience on our website","dismiss":"Got it!","learnMore":"More info","link":null,"theme":"light-bottom"};
</script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js"></script>



<!--SYNTAX HIGHLIGHTER BEGINS-->

<script src="/assets/syntax/syntax.js"></script>

<link rel="stylesheet" href="/assets/syntax/syntax.css" />

<!--SYNTAX HIGHLIGHTER ENDS-->



</body>
</html>
